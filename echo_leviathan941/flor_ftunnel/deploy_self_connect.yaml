description: Runs echo server, client, monitor

services:
  node_a:
    type: tech.florete.network.UdpNode
    uses: {}
    provides: [publisher, connector]
    args:
      name: node_a
      link_cfg:
        local: 127.0.0.1:6142
        peers: [{ addr: 127.0.0.1:6142, services: ["echo_server"] }]

  echo_server:
    type: org.leviathan.echo.flor.Server
    args:
      name: echo_server
      max_connections: 3
    provides: [connection_observable]
    uses:
      publisher: node_a.publisher

  echo_client:
    type: org.leviathan.echo.flor.Client
    args:
      name: echo_client
      server_name: echo_server
    uses:
      connector: node_a.connector

  echo_monitor:
    type: org.leviathan.echo.flor.ConnectionMonitor
    uses:
      connection_observable: echo_server.connection_observable
